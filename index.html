<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blender Style UI Toolkit</title>
  <link rel="stylesheet" href="blender-ui.css">
  <script src="https://unpkg.com/mithril/mithril.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }

    .app-layout {
      display: flex;
      height: 100vh;
    }

    /* Collapsible Navigation Sidebar */
    .app-nav {
      width: 200px;
      min-width: 200px;
      background-color: var(--bl-bg-dark);
      border-right: 1px solid var(--bl-border-dark);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .app-nav.collapsed {
      width: 40px;
      min-width: 40px;
    }

    .app-nav-header {
      display: flex;
      align-items: center;
      height: 28px;
      padding: 0 var(--bl-spacing-sm);
      background-color: var(--bl-bg-light);
      border-bottom: 1px solid var(--bl-border-dark);
      gap: var(--bl-spacing-sm);
    }

    .app-nav-toggle {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      color: var(--bl-text-secondary);
      cursor: pointer;
      border-radius: var(--bl-radius-sm);
      flex-shrink: 0;
    }

    .app-nav-toggle:hover {
      background-color: var(--bl-bg-hover);
      color: var(--bl-text-primary);
    }

    .app-nav-toggle svg {
      width: 14px;
      height: 14px;
      fill: currentColor;
    }

    .app-nav.collapsed .app-nav-toggle svg {
      transform: rotate(180deg);
    }

    .app-nav-title {
      font-size: var(--bl-font-size-sm);
      font-weight: 500;
      color: var(--bl-text-primary);
      white-space: nowrap;
      overflow: hidden;
    }

    .app-nav.collapsed .app-nav-title {
      display: none;
    }

    .app-nav-items {
      flex: 1;
      padding: var(--bl-spacing-sm);
      overflow-y: auto;
    }

    .app-nav-item {
      display: flex;
      align-items: center;
      gap: var(--bl-spacing-md);
      padding: var(--bl-spacing-sm) var(--bl-spacing-md);
      border-radius: var(--bl-radius-md);
      cursor: pointer;
      color: var(--bl-text-secondary);
      font-size: var(--bl-font-size-base);
      white-space: nowrap;
      text-decoration: none;
    }

    .app-nav-item:hover {
      background-color: var(--bl-bg-light);
      color: var(--bl-text-primary);
    }

    .app-nav-item.active {
      background-color: var(--bl-accent-subtle);
      color: var(--bl-accent);
    }

    .app-nav-item svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
      flex-shrink: 0;
    }

    .app-nav-item-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .app-nav.collapsed .app-nav-item {
      padding: var(--bl-spacing-sm);
      justify-content: center;
    }

    .app-nav.collapsed .app-nav-item-label {
      display: none;
    }

    .app-nav-footer {
      padding: var(--bl-spacing-sm);
      border-top: 1px solid var(--bl-border-dark);
    }

    .app-nav-footer .app-nav-item {
      margin-bottom: var(--bl-spacing-xs);
    }

    .app-nav-footer .app-nav-item:last-child {
      margin-bottom: 0;
    }

    /* Main Content Area */
    .app-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Page-specific styles */
    .page-widgets {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .page-widgets .demo-main {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    .page-widgets .demo-sidebar {
      width: 280px;
      background-color: var(--bl-bg-base);
      border-right: 1px solid var(--bl-border-dark);
      overflow-y: auto;
    }

    .page-widgets .demo-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--bl-spacing-lg);
    }

    .demo-section {
      margin-bottom: var(--bl-spacing-xl);
      padding: var(--bl-spacing-lg);
      background-color: var(--bl-bg-base);
      border-radius: var(--bl-radius-md);
    }

    .demo-section-title {
      font-size: var(--bl-font-size-sm);
      font-weight: 500;
      color: var(--bl-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--bl-spacing-lg);
      padding-bottom: var(--bl-spacing-sm);
      border-bottom: 1px solid var(--bl-border-dark);
    }

    .demo-row {
      display: flex;
      flex-wrap: wrap;
      gap: var(--bl-spacing-md);
      margin-bottom: var(--bl-spacing-md);
    }

    .demo-label {
      font-size: var(--bl-font-size-sm);
      color: var(--bl-text-muted);
      margin-bottom: var(--bl-spacing-xs);
    }

    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: var(--bl-spacing-md);
    }

    .icon-placeholder {
      width: 14px;
      height: 14px;
      background-color: currentColor;
      opacity: 0.7;
      border-radius: 2px;
    }

    /* Profiler page styles */
    .page-profiler {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .profiler-main {
      display: flex;
      flex-direction: column;
      flex: 1;
      overflow: hidden;
    }

    .profiler-timeline-area {
      flex: 1;
      display: flex;
      overflow: hidden;
      min-height: 200px;
    }

    .profiler-timeline-area .bl-timeline {
      flex: 1;
      display: flex;
      flex-direction: column;
      border: none;
      border-radius: 0;
    }

    .profiler-details {
      height: 200px;
      min-height: 100px;
      max-height: 50vh;
      background-color: var(--bl-bg-base);
      border-top: 1px solid var(--bl-border-dark);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .profiler-details-tabs-primary {
      display: flex;
      align-items: flex-end;
      height: 30px;
      padding: 0 var(--bl-spacing-sm);
      background-color: var(--bl-bg-dark);
      border-bottom: 1px solid var(--bl-border-button);
      gap: var(--bl-spacing-md);
    }

    .details-primary-tabs {
      display: flex;
      gap: 1px;
      flex: 1;
    }

    .details-primary-tab {
      padding: 6px 12px;
      font-family: var(--bl-font-family);
      font-size: var(--bl-font-size-sm);
      color: var(--bl-text-secondary);
      background: transparent;
      border: 1px solid transparent;
      border-bottom: none;
      border-radius: var(--bl-radius-sm) var(--bl-radius-sm) 0 0;
      cursor: pointer;
    }

    .details-primary-tab:hover {
      color: var(--bl-text-primary);
      background-color: var(--bl-bg-light);
    }

    .details-primary-tab.active {
      color: var(--bl-text-primary);
      background-color: var(--bl-bg-base);
      border-color: var(--bl-border-button);
      box-shadow: var(--bl-button-highlight);
      margin-bottom: -1px;
      padding-bottom: 7px;
    }

    .profiler-details-actions {
      display: flex;
      gap: 2px;
      padding-bottom: 4px;
    }

    .profiler-details-header {
      display: flex;
      align-items: center;
      height: 28px;
      padding: 0 var(--bl-spacing-md);
      background-color: var(--bl-bg-base);
      border-bottom: 1px solid var(--bl-border-dark);
      gap: var(--bl-spacing-md);
    }

    .details-secondary-tabs {
      display: inline-flex;
      border: 1px solid var(--bl-border-button);
      border-radius: var(--bl-radius-md);
    }

    .details-secondary-tab {
      padding: 4px 10px;
      font-family: var(--bl-font-family);
      font-size: var(--bl-font-size-sm);
      color: var(--bl-text-secondary);
      background-color: var(--bl-bg-base);
      border: none;
      border-radius: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
    }

    .details-secondary-tab:first-child {
      border-radius: var(--bl-radius-sm) 0 0 var(--bl-radius-sm);
    }

    .details-secondary-tab:last-child {
      border-radius: 0 var(--bl-radius-sm) var(--bl-radius-sm) 0;
    }

    .details-secondary-tab:only-child {
      border-radius: var(--bl-radius-sm);
    }

    .details-secondary-tab:hover {
      color: var(--bl-text-primary);
      background-color: var(--bl-bg-light);
    }

    .details-secondary-tab.active {
      color: var(--bl-text-primary);
      background-color: var(--bl-bg-light);
      box-shadow: var(--bl-highlight-top);
    }

    .profiler-details-title {
      font-size: var(--bl-font-size-base);
      font-weight: 500;
      color: var(--bl-text-primary);
    }

    .profiler-details-content {
      flex: 1;
      overflow: auto;
      padding: var(--bl-spacing-md);
    }

    .profiler-resize-handle {
      height: 4px;
      background-color: var(--bl-bg-light);
      cursor: ns-resize;
    }

    .profiler-resize-handle:hover {
      background-color: var(--bl-accent);
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--bl-spacing-lg);
    }

    .details-section {
      background-color: var(--bl-bg-dark);
      border-radius: var(--bl-radius-md);
      padding: var(--bl-spacing-md);
    }

    .details-section-title {
      font-size: var(--bl-font-size-sm);
      font-weight: 500;
      color: var(--bl-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--bl-spacing-md);
      padding-bottom: var(--bl-spacing-sm);
      border-bottom: 1px solid var(--bl-border-dark);
    }

    .details-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--bl-spacing-xs) 0;
      font-size: var(--bl-font-size-base);
    }

    .details-label {
      color: var(--bl-text-secondary);
    }

    .details-value {
      font-family: var(--bl-font-mono);
      color: var(--bl-text-primary);
    }

    .details-value.highlight {
      color: var(--bl-accent);
    }

    .flame-bar {
      height: 8px;
      background-color: var(--bl-bg-dark);
      border-radius: var(--bl-radius-sm);
      margin-top: var(--bl-spacing-sm);
      overflow: hidden;
      display: flex;
    }

    .flame-bar-segment {
      height: 100%;
    }

    /* Plugins page styles */
    .page-plugins {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .plugins-main {
      flex: 1;
      overflow-y: auto;
      padding: var(--bl-spacing-lg);
    }

    .plugins-list {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: var(--bl-spacing-md);
    }

    .plugin-item {
      background-color: var(--bl-bg-base);
      border: 1px solid var(--bl-border-dark);
      border-radius: var(--bl-radius-md);
      padding: var(--bl-spacing-md);
      box-shadow: var(--bl-button-highlight);
    }

    .plugin-item.disabled {
      opacity: 0.7;
    }

    .plugin-header {
      display: flex;
      align-items: center;
      gap: var(--bl-spacing-md);
      margin-bottom: var(--bl-spacing-sm);
    }

    .plugin-header .bl-checkbox {
      margin: 0;
    }

    .plugin-info {
      flex: 1;
      display: flex;
      align-items: baseline;
      gap: var(--bl-spacing-md);
    }

    .plugin-name {
      font-weight: 500;
      color: var(--bl-text-primary);
      font-size: var(--bl-font-size-lg);
    }

    .plugin-version {
      font-size: var(--bl-font-size-sm);
      color: var(--bl-text-muted);
      font-family: var(--bl-font-mono);
    }

    .plugin-actions {
      display: flex;
      gap: var(--bl-spacing-xs);
    }

    .plugin-description {
      color: var(--bl-text-secondary);
      font-size: var(--bl-font-size-base);
      line-height: 1.5;
      margin-bottom: var(--bl-spacing-sm);
      padding-left: 28px;
    }

    .plugin-meta {
      display: flex;
      align-items: center;
      gap: var(--bl-spacing-md);
      padding-left: 28px;
    }

    .plugin-author {
      font-size: var(--bl-font-size-sm);
      color: var(--bl-text-muted);
    }
  </style>
</head>
<body class="bl-root">
  <div id="app"></div>

  <script>
    // Application state
    var State = {
      navCollapsed: false,
      activeTab: 'Scene',
      activePrimaryTab: 'Selection',
      activeSecondaryTab: 'Summary',
      detailsPanelHeight: 200,
      collapsedTrackGroups: {},
      collapsedTracks: {}
    };

    // Theme management
    function loadTheme() {
      var savedTheme = localStorage.getItem('bl-theme');
      if (savedTheme === 'light') {
        document.body.classList.add('bl-theme-light');
      }
    }

    function toggleTheme() {
      document.body.classList.toggle('bl-theme-light');
      var isLight = document.body.classList.contains('bl-theme-light');
      localStorage.setItem('bl-theme', isLight ? 'light' : 'dark');
    }

    loadTheme();

    // Navigation component
    function NavItem(route, icon, label) {
      var currentRoute = m.route.get();
      var isActive = currentRoute === route;
      return m('a.app-nav-item', {
        class: isActive ? 'active' : '',
        href: '#!/' + route,
        oncreate: m.route.link,
        onupdate: m.route.link
      }, [
        m.trust(icon),
        m('span.app-nav-item-label', label)
      ]);
    }

    function Nav() {
      return {
        view: function() {
          return m('nav.app-nav', { class: State.navCollapsed ? 'collapsed' : '', id: 'appNav' }, [
            m('.app-nav-header', [
              m('button.app-nav-toggle', {
                onclick: function() { State.navCollapsed = !State.navCollapsed; },
                title: 'Toggle sidebar'
              }, m.trust('<svg viewBox="0 0 16 16"><path d="M11 3L5 8l6 5V3z"/></svg>')),
              m('span.app-nav-title', 'Blender UI')
            ]),
            m('.app-nav-items', [
              NavItem('widgets', '<svg viewBox="0 0 16 16"><path d="M2 2h5v5H2V2zm7 0h5v5H9V2zM2 9h5v5H2V9zm7 0h5v5H9V9z"/></svg>', 'Widgets'),
              NavItem('profiler', '<svg viewBox="0 0 16 16"><path d="M1 14h14v1H1v-1zm1-3h2v3H2v-3zm3-2h2v5H5V9zm3-4h2v9H8V5zm3 2h2v7h-2V7z"/></svg>', 'Profiler'),
              NavItem('plugins', '<svg viewBox="0 0 16 16"><path d="M6 1v3H4.5A1.5 1.5 0 0 0 3 5.5v1A1.5 1.5 0 0 0 4.5 8H6v7h4V8h1.5A1.5 1.5 0 0 0 13 6.5v-1A1.5 1.5 0 0 0 11.5 4H10V1H6z"/></svg>', 'Plugins')
            ]),
            m('.app-nav-footer', [
              m('.app-nav-item', { onclick: toggleTheme }, [
                m.trust('<svg viewBox="0 0 16 16"><path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zm0 12.5V2.5a5.5 5.5 0 0 1 0 11z"/></svg>'),
                m('span.app-nav-item-label', 'Toggle Theme')
              ])
            ])
          ]);
        }
      };
    }

    // Widgets Page
    var WidgetsPage = {
      view: function() {
        return m('.page-widgets', [
          // Header Bar
          m('header.bl-header', [
            m('.bl-header-menu', [
              m('.bl-header-menu-item', 'File'),
              m('.bl-header-menu-item', 'Edit'),
              m('.bl-header-menu-item', 'View'),
              m('.bl-header-menu-item', 'Object'),
              m('.bl-header-menu-item', 'Help')
            ])
          ]),

          m('.demo-main', [
            // Sidebar with Panels
            m('aside.demo-sidebar', [
              // Transform Panel
              m('.bl-panel', [
                m('.bl-panel-header', { onclick: function(e) { e.target.closest('.bl-panel').classList.toggle('collapsed'); } }, [
                  m('.bl-panel-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                  m('span.bl-panel-title', 'Transform')
                ]),
                m('.bl-panel-content', [
                  m('.bl-form-row', [
                    m('label.bl-form-label', 'Location'),
                    m('.bl-flex.bl-gap-xs', [
                      m('.bl-number-input', [
                        m('span.bl-number-label', 'X'),
                        m('input[type=text]', { value: '0.000' })
                      ])
                    ])
                  ]),
                  m('.bl-form-row', [
                    m('label.bl-form-label'),
                    m('.bl-flex.bl-gap-xs', [
                      m('.bl-number-input', [
                        m('span.bl-number-label', 'Y'),
                        m('input[type=text]', { value: '0.000' })
                      ])
                    ])
                  ]),
                  m('.bl-form-row', [
                    m('label.bl-form-label'),
                    m('.bl-flex.bl-gap-xs', [
                      m('.bl-number-input', [
                        m('span.bl-number-label', 'Z'),
                        m('input[type=text]', { value: '0.000' })
                      ])
                    ])
                  ])
                ])
              ]),

              // Material Panel
              m('.bl-panel', [
                m('.bl-panel-header', { onclick: function(e) { e.target.closest('.bl-panel').classList.toggle('collapsed'); } }, [
                  m('.bl-panel-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                  m('span.bl-panel-title', 'Material')
                ]),
                m('.bl-panel-content', [
                  m('.bl-form-row', [
                    m('label.bl-form-label', 'Base Color'),
                    m('.bl-color-swatch', [
                      m('.bl-color-preview', { style: { backgroundColor: '#e87d0d' } }),
                      m('span.bl-color-value', '#E87D0D')
                    ])
                  ]),
                  m('.bl-form-row', [
                    m('label.bl-form-label', 'Metallic'),
                    m('.bl-slider', [
                      m('input[type=range]', { min: 0, max: 100, value: 0 }),
                      m('span.bl-slider-value', '0.00')
                    ])
                  ]),
                  m('.bl-form-row', [
                    m('label.bl-form-label', 'Roughness'),
                    m('.bl-slider', [
                      m('input[type=range]', { min: 0, max: 100, value: 50 }),
                      m('span.bl-slider-value', '0.50')
                    ])
                  ])
                ])
              ]),

              // Tree View Panel
              m('.bl-panel', [
                m('.bl-panel-header', { onclick: function(e) { e.target.closest('.bl-panel').classList.toggle('collapsed'); } }, [
                  m('.bl-panel-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                  m('span.bl-panel-title', 'Scene Collection')
                ]),
                m('.bl-panel-content', [
                  m('.bl-tree', [
                    m('.bl-tree-item', { onclick: function(e) { e.target.closest('.bl-tree-item').classList.toggle('collapsed'); } }, [
                      m('.bl-tree-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                      m('.bl-tree-icon', m('.icon-placeholder')),
                      m('span', 'Collection')
                    ]),
                    m('.bl-tree-children', [
                      m('.bl-tree-item.active', [
                        m('.bl-tree-toggle'),
                        m('.bl-tree-icon', m('.icon-placeholder')),
                        m('span', 'Cube')
                      ]),
                      m('.bl-tree-item', [
                        m('.bl-tree-toggle'),
                        m('.bl-tree-icon', m('.icon-placeholder')),
                        m('span', 'Camera')
                      ]),
                      m('.bl-tree-item', [
                        m('.bl-tree-toggle'),
                        m('.bl-tree-icon', m('.icon-placeholder')),
                        m('span', 'Light')
                      ])
                    ])
                  ])
                ])
              ])
            ]),

            // Main Content Area
            m('.demo-content', [
              // Buttons Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Buttons'),
                m('.demo-label', 'Standard Buttons'),
                m('.demo-row', [
                  m('button.bl-btn', 'Default'),
                  m('button.bl-btn.bl-btn-primary', 'Primary'),
                  m('button.bl-btn', { disabled: true }, 'Disabled')
                ]),
                m('.demo-label', 'Icon Buttons'),
                m('.demo-row', [
                  m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Move' }, m('.icon-placeholder')),
                  m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Rotate' }, m('.icon-placeholder')),
                  m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Scale' }, m('.icon-placeholder'))
                ]),
                m('.demo-label', 'Button Group'),
                m('.demo-row', [
                  m('.bl-btn-group', [
                    m('button.bl-btn.bl-btn-toggle.active', 'Object'),
                    m('button.bl-btn.bl-btn-toggle', 'Edit'),
                    m('button.bl-btn.bl-btn-toggle', 'Sculpt')
                  ])
                ]),
                m('.demo-label', 'Segmented Buttons'),
                m('.demo-row', [
                  m('.bl-segmented', [
                    m('button.bl-segmented-btn.active', 'Vertex'),
                    m('button.bl-segmented-btn', 'Edge'),
                    m('button.bl-segmented-btn', 'Face')
                  ]),
                  m('.bl-segmented', [
                    m('button.bl-segmented-btn.icon-only.active', { title: 'Grid' }, m.trust('<svg viewBox="0 0 16 16"><path d="M1 1h6v6H1V1zm8 0h6v6H9V1zM1 9h6v6H1V9zm8 0h6v6H9V9z"/></svg>')),
                    m('button.bl-segmented-btn.icon-only', { title: 'List' }, m.trust('<svg viewBox="0 0 16 16"><path d="M1 2h14v2H1V2zm0 5h14v2H1V7zm0 5h14v2H1v-2z"/></svg>')),
                    m('button.bl-segmented-btn.icon-only', { title: 'Details' }, m.trust('<svg viewBox="0 0 16 16"><path d="M1 1h4v4H1V1zm6 1h8v2H7V2zM1 6h4v4H1V6zm6 1h8v2H7V7zM1 11h4v4H1v-4zm6 1h8v2H7v-2z"/></svg>'))
                  ])
                ]),
                m('.demo-row', [
                  m('.bl-segmented', [
                    m('button.bl-segmented-btn.icon-only', { title: 'Align Left' }, m.trust('<svg viewBox="0 0 16 16"><path d="M1 2h10v2H1V2zm0 4h14v2H1V6zm0 4h8v2H1v-2zm0 4h12v2H1v-2z"/></svg>')),
                    m('button.bl-segmented-btn.icon-only.active', { title: 'Align Center' }, m.trust('<svg viewBox="0 0 16 16"><path d="M3 2h10v2H3V2zm1 4h8v2H4V6zm2 4h4v2H6v-2zm1 4h2v2H7v-2z"/></svg>')),
                    m('button.bl-segmented-btn.icon-only', { title: 'Align Right' }, m.trust('<svg viewBox="0 0 16 16"><path d="M5 2h10v2H5V2zm1 4h9v2H6V6zm2 4h7v2H8v-2zm1 4h6v2H9v-2z"/></svg>'))
                  ]),
                  m('.bl-segmented', [
                    m('button.bl-segmented-btn', [
                      m.trust('<svg viewBox="0 0 16 16"><path d="M8 1l7 14H1L8 1z"/></svg>'),
                      ' Solid'
                    ]),
                    m('button.bl-segmented-btn.active', [
                      m.trust('<svg viewBox="0 0 16 16"><path d="M8 1l7 14H1L8 1z" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>'),
                      ' Wire'
                    ])
                  ])
                ])
              ]),

              // Text Inputs Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Text Inputs'),
                m('.demo-label', 'Standard Input'),
                m('.demo-row', [
                  m('input.bl-input[type=text]', { placeholder: 'Enter text...' }),
                  m('input.bl-input[type=text]', { value: 'With value' }),
                  m('input.bl-input[type=text]', { disabled: true, value: 'Disabled' })
                ]),
                m('.demo-label', 'Number Inputs'),
                m('.demo-row', [
                  m('.bl-number-input', [m('span.bl-number-label', 'X'), m('input[type=text]', { value: '0.000' })]),
                  m('.bl-number-input', [m('span.bl-number-label', 'Y'), m('input[type=text]', { value: '0.000' })]),
                  m('.bl-number-input', [m('span.bl-number-label', 'Z'), m('input[type=text]', { value: '0.000' })])
                ])
              ]),

              // Selects Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Select Inputs'),
                m('.demo-row', [
                  m('.bl-select', m('select', [
                    m('option', 'Object Mode'),
                    m('option', 'Edit Mode'),
                    m('option', 'Sculpt Mode')
                  ])),
                  m('.bl-select', m('select', [
                    m('option', 'Solid'),
                    m('option', 'Wireframe'),
                    m('option', 'Material Preview')
                  ]))
                ])
              ]),

              // Checkboxes & Radio Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Checkboxes & Radio Buttons'),
                m('.demo-label', 'Checkboxes'),
                m('.demo-row', [
                  m('label.bl-checkbox', [m('input[type=checkbox]', { checked: true }), ' Show Overlays']),
                  m('label.bl-checkbox', [m('input[type=checkbox]', { checked: true }), ' Show Floor']),
                  m('label.bl-checkbox', [m('input[type=checkbox]'), ' Show Axes'])
                ]),
                m('.demo-label', 'Disabled Checkboxes'),
                m('.demo-row', [
                  m('label.bl-checkbox', [m('input[type=checkbox]', { checked: true, disabled: true }), ' Checked Disabled']),
                  m('label.bl-checkbox', [m('input[type=checkbox]', { disabled: true }), ' Unchecked Disabled'])
                ]),
                m('.demo-label', 'Radio Buttons'),
                m('.demo-row', [
                  m('label.bl-radio', [m('input[type=radio]', { name: 'pivot', checked: true }), ' Median Point']),
                  m('label.bl-radio', [m('input[type=radio]', { name: 'pivot' }), ' 3D Cursor']),
                  m('label.bl-radio', [m('input[type=radio]', { name: 'pivot' }), ' Active Element'])
                ]),
                m('.demo-label', 'Disabled Radio Buttons'),
                m('.demo-row', [
                  m('label.bl-radio', [m('input[type=radio]', { name: 'disabled-radio', checked: true, disabled: true }), ' Selected Disabled']),
                  m('label.bl-radio', [m('input[type=radio]', { name: 'disabled-radio', disabled: true }), ' Unselected Disabled'])
                ])
              ]),

              // Sliders Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Sliders & Progress'),
                m('.demo-label', 'Sliders'),
                m('.demo-grid', [
                  m('.bl-slider', [
                    m('input[type=range]', { min: 0, max: 100, value: 75, oninput: function(e) { e.target.nextElementSibling.textContent = (e.target.value / 100).toFixed(2); } }),
                    m('span.bl-slider-value', '0.75')
                  ]),
                  m('.bl-slider', [
                    m('input[type=range]', { min: 0, max: 100, value: 25, oninput: function(e) { e.target.nextElementSibling.textContent = (e.target.value / 100).toFixed(2); } }),
                    m('span.bl-slider-value', '0.25')
                  ])
                ]),
                m('.demo-label.bl-mt-md', 'Progress Bars'),
                m('div', { style: { maxWidth: '400px' } }, [
                  m('.bl-progress.bl-mb-md', m('.bl-progress-bar', { style: { width: '75%' } })),
                  m('.bl-progress', m('.bl-progress-bar', { style: { width: '45%' } }))
                ])
              ]),

              // Tabs Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Tabs'),
                m('.bl-tabs', [
                  m('button.bl-tab', { class: State.activeTab === 'Scene' ? 'active' : '', onclick: function() { State.activeTab = 'Scene'; } }, 'Scene'),
                  m('button.bl-tab', { class: State.activeTab === 'World' ? 'active' : '', onclick: function() { State.activeTab = 'World'; } }, 'World'),
                  m('button.bl-tab', { class: State.activeTab === 'Object' ? 'active' : '', onclick: function() { State.activeTab = 'Object'; } }, 'Object'),
                  m('button.bl-tab', { class: State.activeTab === 'Modifiers' ? 'active' : '', onclick: function() { State.activeTab = 'Modifiers'; } }, 'Modifiers')
                ]),
                m('.bl-tab-content', m('p', { style: { color: 'var(--bl-text-secondary)', margin: 0 } }, 'Tab content area'))
              ]),

              // Table Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Table'),
                m('table.bl-table', [
                  m('thead', m('tr', [
                    m('th', 'Name'),
                    m('th', 'Type'),
                    m('th', 'Vertices'),
                    m('th', 'Status')
                  ])),
                  m('tbody', [
                    m('tr.selected', [
                      m('td', 'Cube'),
                      m('td', 'Mesh'),
                      m('td', '8'),
                      m('td', m('span.bl-badge.bl-badge-success', 'Active'))
                    ]),
                    m('tr', [
                      m('td', 'Suzanne'),
                      m('td', 'Mesh'),
                      m('td', '507'),
                      m('td', m('span.bl-badge', 'Hidden'))
                    ]),
                    m('tr', [
                      m('td', 'Sphere'),
                      m('td', 'Mesh'),
                      m('td', '482'),
                      m('td', m('span.bl-badge.bl-badge-warning', 'Modified'))
                    ])
                  ])
                ])
              ]),

              // Badges Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Badges'),
                m('.demo-row', [
                  m('span.bl-badge', 'Default'),
                  m('span.bl-badge.bl-badge-success', 'Success'),
                  m('span.bl-badge.bl-badge-warning', 'Warning'),
                  m('span.bl-badge.bl-badge-error', 'Error')
                ])
              ]),

              // Menu Section
              m('section.demo-section', [
                m('h2.demo-section-title', 'Dropdown Menu'),
                m('.demo-row', [
                  m('.bl-menu', { style: { display: 'inline-block' } }, [
                    m('.bl-menu-item', [m('span', 'New'), m('span.bl-menu-item-shortcut', 'Ctrl+N')]),
                    m('.bl-menu-item', [m('span', 'Open...'), m('span.bl-menu-item-shortcut', 'Ctrl+O')]),
                    m('.bl-menu-item', [m('span', 'Save'), m('span.bl-menu-item-shortcut', 'Ctrl+S')]),
                    m('.bl-menu-separator'),
                    m('.bl-menu-item.disabled', m('span', 'Recover Last Session'))
                  ])
                ])
              ])
            ])
          ]),

          // Status Bar
          m('footer.bl-statusbar', [
            m('span.bl-statusbar-item', 'Verts: 8'),
            m('span.bl-statusbar-item', 'Faces: 6'),
            m('span.bl-statusbar-item', 'Objects: 3/3'),
            m('span.bl-statusbar-item', { style: { marginLeft: 'auto', borderRight: 'none' } }, 'Blender UI Toolkit v1.0')
          ])
        ]);
      }
    };

    // Profiler Page
    var ProfilerPage = {
      oncreate: function(vnode) {
        // Setup resize handle
        var resizeHandle = vnode.dom.querySelector('#resizeHandle');
        var detailsPanel = vnode.dom.querySelector('#detailsPanel');
        var isResizing = false;

        if (resizeHandle && detailsPanel) {
          resizeHandle.addEventListener('mousedown', function(e) {
            isResizing = true;
            document.body.style.cursor = 'ns-resize';
            document.body.style.userSelect = 'none';
          });

          document.addEventListener('mousemove', function(e) {
            if (!isResizing) return;
            var containerRect = detailsPanel.parentElement.getBoundingClientRect();
            var newHeight = containerRect.bottom - e.clientY;
            if (newHeight >= 100 && newHeight <= window.innerHeight * 0.5) {
              detailsPanel.style.height = newHeight + 'px';
              State.detailsPanelHeight = newHeight;
            }
          });

          document.addEventListener('mouseup', function() {
            isResizing = false;
            document.body.style.cursor = '';
            document.body.style.userSelect = '';
          });
        }
      },

      view: function() {
        function toggleTrackGroup(groupId) {
          State.collapsedTrackGroups[groupId] = !State.collapsedTrackGroups[groupId];
        }

        function toggleTrack(trackId) {
          State.collapsedTracks[trackId] = !State.collapsedTracks[trackId];
        }

        function expandAllTracks() {
          State.collapsedTrackGroups = {};
          State.collapsedTracks = {};
        }

        function collapseAllTracks() {
          State.collapsedTrackGroups = { 'main-thread': true, 'gpu': true, 'workers': true };
          State.collapsedTracks = { 'frame': true, 'scripts': true, 'paint': true };
        }

        return m('.page-profiler', [
          // Header Bar
          m('header.bl-header', [
            m('.bl-header-menu', [
              m('.bl-header-menu-item', 'File'),
              m('.bl-header-menu-item', 'Edit'),
              m('.bl-header-menu-item', 'View'),
              m('.bl-header-menu-item', 'Profile'),
              m('.bl-header-menu-item', 'Help')
            ]),
            m('div', { style: { marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: 'var(--bl-spacing-md)' } }, [
              m('span.bl-badge.bl-badge-success', 'Recording'),
              m('button.bl-btn.bl-btn-primary', 'Stop')
            ])
          ]),

          m('.profiler-main', [
            m('.profiler-timeline-area', [
              m('.bl-timeline', [
                // Timeline Header
                m('.bl-timeline-header', [
                  m('span.bl-timeline-title', 'Frame Profile - Frame #1247'),
                  m('.bl-btn-group', [
                    m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Previous Frame' },
                      m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M11 3L5 8l6 5V3z"/><rect x="3" y="3" width="2" height="10"/></svg>')),
                    m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Next Frame' },
                      m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M5 3l6 5-6 5V3z"/><rect x="11" y="3" width="2" height="10"/></svg>'))
                  ]),
                  m('.bl-timeline-controls', [
                    m('.bl-select', m('select', [
                      m('option', 'All Threads'),
                      m('option', 'Main Thread'),
                      m('option', 'GPU')
                    ])),
                    m('.bl-timeline-zoom', [
                      m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Zoom Out' },
                        m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><rect x="3" y="7" width="10" height="2"/></svg>')),
                      m('span', '100%'),
                      m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Zoom In' },
                        m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><rect x="3" y="7" width="10" height="2"/><rect x="7" y="3" width="2" height="10"/></svg>'))
                    ]),
                    m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Fit to Window' },
                      m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M2 2h4v2H4v2H2V2zm8 0h4v4h-2V4h-2V2zM4 10H2v4h4v-2H4v-2zm8 2v2h-2v2h4v-4h-2z"/></svg>'))
                  ])
                ]),

                // Timeline Minimap
                m('.bl-timeline-minimap', [
                  m('.bl-timeline-minimap-slice', { style: { left: '2%', width: '50%', top: '6px', backgroundColor: '#5a9a5a' } }),
                  m('.bl-timeline-minimap-slice', { style: { left: '55%', width: '15%', top: '10px', backgroundColor: '#d4842a' } }),
                  m('.bl-timeline-minimap-slice', { style: { left: '70%', width: '20%', top: '14px', backgroundColor: '#8a6ab5' } }),
                  m('.bl-timeline-minimap-slice', { style: { left: '3%', width: '45%', top: '20px', backgroundColor: '#b54a4a' } }),
                  m('.bl-timeline-minimap-viewport', { style: { left: '0%', width: '100%' } })
                ]),

                // Timeline Body
                m('.bl-timeline-body', [
                  m('.bl-timeline-ruler-row', [
                    m('.bl-timeline-tracks-header', [
                      m('.bl-track-search', [
                        m.trust('<svg viewBox="0 0 16 16"><path d="M11.5 10.5L15 14M10 6.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>'),
                        m('input[type=text]', { placeholder: 'Filter tracks...' })
                      ]),
                      m('.bl-track-header-actions', [
                        m('button.bl-track-btn.bl-tooltip', { 'data-tooltip': 'Expand All', onclick: expandAllTracks },
                          m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M3 4h10v2H3V4zm3 4h4v2H6V8zm-3 4h10v2H3v-2z"/></svg>')),
                        m('button.bl-track-btn.bl-tooltip', { 'data-tooltip': 'Collapse All', onclick: collapseAllTracks },
                          m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M3 7h10v2H3V7z"/></svg>'))
                      ])
                    ]),
                    m('.bl-timeline-ruler', [
                      m('.bl-timeline-ruler-inner', [
                        m('.bl-timeline-ruler-mark.major', { style: { left: '0' } }, m('span', '0ms')),
                        m('.bl-timeline-ruler-mark.major', { style: { left: '25%' } }, m('span', '4ms')),
                        m('.bl-timeline-ruler-mark.major', { style: { left: '50%' } }, m('span', '8ms')),
                        m('.bl-timeline-ruler-mark.major', { style: { left: '75%' } }, m('span', '12ms')),
                        m('.bl-timeline-ruler-mark.major', { style: { left: '100%' } }, m('span', '16ms'))
                      ])
                    ])
                  ]),

                  m('.bl-timeline-scroll', [
                    m('.bl-timeline-tracks', [
                      // Main Thread Group
                      m('.bl-track-group', {
                        'data-group': 'main-thread',
                        class: State.collapsedTrackGroups['main-thread'] ? 'collapsed' : ''
                      }, [
                        m('.bl-track-group-header', { onclick: function() { toggleTrackGroup('main-thread'); } }, [
                          m('.bl-track-group-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                          m('span.bl-track-group-name', 'Main Thread'),
                          m('.bl-track-buttons', [
                            m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                              m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>')),
                            m('button.bl-track-btn', { title: 'More', onclick: function(e) { e.stopPropagation(); } },
                              m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'))
                          ])
                        ]),
                        m('.bl-track-group-content', [
                          // Frame Track
                          m('.bl-track.expandable', {
                            'data-track': 'frame',
                            'data-depth': '1',
                            class: State.collapsedTracks['frame'] ? 'collapsed' : '',
                            onclick: function() { toggleTrack('frame'); }
                          }, [
                            m('.bl-track-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                            m('span.bl-track-name', 'Frame'),
                            m('.bl-track-buttons', [
                              m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>')),
                              m('button.bl-track-btn', { title: 'More', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'))
                            ])
                          ]),
                          !State.collapsedTracks['frame'] && m('.bl-track-children', { 'data-track': 'frame' }, [
                            // Scripts Track
                            m('.bl-track.expandable', {
                              'data-track': 'scripts',
                              'data-depth': '2',
                              class: State.collapsedTracks['scripts'] ? 'collapsed' : '',
                              onclick: function(e) { e.stopPropagation(); toggleTrack('scripts'); }
                            }, [
                              m('.bl-track-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                              m('span.bl-track-name', 'Scripts'),
                              m('.bl-track-buttons', [
                                m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                  m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                              ])
                            ]),
                            !State.collapsedTracks['scripts'] && m('.bl-track-children', { 'data-track': 'scripts' }, [
                              m('.bl-track', { 'data-depth': '3' }, [
                                m('span.bl-track-name', 'updateScene()'),
                                m('.bl-track-buttons', [
                                  m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                    m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                                ])
                              ]),
                              m('.bl-track', { 'data-depth': '3' }, [
                                m('span.bl-track-name', 'processInput()'),
                                m('.bl-track-buttons', [
                                  m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                    m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                                ])
                              ])
                            ]),
                            m('.bl-track', { 'data-depth': '2' }, [
                              m('span.bl-track-name', 'Layout'),
                              m('.bl-track-buttons', [
                                m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                  m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                              ])
                            ]),
                            // Paint Track
                            m('.bl-track.expandable', {
                              'data-track': 'paint',
                              'data-depth': '2',
                              class: State.collapsedTracks['paint'] ? 'collapsed' : '',
                              onclick: function(e) { e.stopPropagation(); toggleTrack('paint'); }
                            }, [
                              m('.bl-track-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                              m('span.bl-track-name', 'Paint'),
                              m('.bl-track-buttons', [
                                m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                  m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                              ])
                            ]),
                            !State.collapsedTracks['paint'] && m('.bl-track-children', { 'data-track': 'paint' }, [
                              m('.bl-track', { 'data-depth': '3' }, m('span.bl-track-name', 'paint')),
                              m('.bl-track', { 'data-depth': '3' }, m('span.bl-track-name', 'rasterize'))
                            ])
                          ])
                        ])
                      ]),

                      // GPU Group
                      m('.bl-track-group', {
                        'data-group': 'gpu',
                        class: State.collapsedTrackGroups['gpu'] ? 'collapsed' : ''
                      }, [
                        m('.bl-track-group-header', { onclick: function() { toggleTrackGroup('gpu'); } }, [
                          m('.bl-track-group-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                          m('span.bl-track-group-name', 'GPU'),
                          m('.bl-track-buttons', [
                            m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                              m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                          ])
                        ]),
                        m('.bl-track-group-content', [
                          m('.bl-track', [
                            m('span.bl-track-name', 'Render Pass'),
                            m('.bl-track-buttons', [
                              m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                            ])
                          ]),
                          m('.bl-track', [
                            m('span.bl-track-name', 'Compositing'),
                            m('.bl-track-buttons', [
                              m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                            ])
                          ])
                        ])
                      ]),

                      // Workers Group
                      m('.bl-track-group', {
                        'data-group': 'workers',
                        class: State.collapsedTrackGroups['workers'] ? 'collapsed' : ''
                      }, [
                        m('.bl-track-group-header', { onclick: function() { toggleTrackGroup('workers'); } }, [
                          m('.bl-track-group-toggle', m.trust('<svg viewBox="0 0 10 10"><path d="M2 1 L8 5 L2 9 Z"/></svg>')),
                          m('span.bl-track-group-name', 'Worker Threads'),
                          m('.bl-track-buttons', [
                            m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                              m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                          ])
                        ]),
                        m('.bl-track-group-content', [
                          m('.bl-track', [
                            m('span.bl-track-name', 'Worker 1'),
                            m('.bl-track-buttons', [
                              m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                            ])
                          ]),
                          m('.bl-track', [
                            m('span.bl-track-name', 'Worker 2'),
                            m('.bl-track-buttons', [
                              m('button.bl-track-btn', { title: 'Pin', onclick: function(e) { e.stopPropagation(); } },
                                m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>'))
                            ])
                          ])
                        ])
                      ])
                    ]),

                    m('.bl-timeline-lanes-column', [
                      m('.bl-timeline-lanes-inner', { style: { width: '100%', minHeight: '100%' } }, [
                        // Grid Lines
                        m('.bl-timeline-grid', [
                          m('.bl-timeline-grid-line.major', { style: { left: '0' } }),
                          m('.bl-timeline-grid-line', { style: { left: '12.5%' } }),
                          m('.bl-timeline-grid-line.major', { style: { left: '25%' } }),
                          m('.bl-timeline-grid-line', { style: { left: '37.5%' } }),
                          m('.bl-timeline-grid-line.major', { style: { left: '50%' } }),
                          m('.bl-timeline-grid-line', { style: { left: '62.5%' } }),
                          m('.bl-timeline-grid-line.major', { style: { left: '75%' } }),
                          m('.bl-timeline-grid-line', { style: { left: '87.5%' } })
                        ]),

                        m('.bl-timeline-playhead', { style: { left: '32%' } }),

                        // Main Thread Lanes
                        m('.bl-lane-group', {
                          'data-group': 'main-thread',
                          class: State.collapsedTrackGroups['main-thread'] ? 'collapsed' : ''
                        }, [
                          m('.bl-lane-group-header'),
                          m('.bl-lane-group-content', [
                            m('.bl-timeline-lane', [
                              m('.bl-slice.bl-slice-blue', { style: { left: '1%', width: '98%' } }, [
                                m('span.bl-slice-label', 'requestAnimationFrame'),
                                m('span.bl-slice-duration', '16.4ms')
                              ])
                            ]),
                            !State.collapsedTracks['frame'] && m('.bl-lane-children', { 'data-track': 'frame' }, [
                              m('.bl-timeline-lane', [
                                m('.bl-slice.bl-slice-green', { style: { left: '2%', width: '50%' } }, [
                                  m('span.bl-slice-label', 'Scripts'),
                                  m('span.bl-slice-duration', '8.2ms')
                                ])
                              ]),
                              !State.collapsedTracks['scripts'] && m('.bl-lane-children', { 'data-track': 'scripts' }, [
                                m('.bl-timeline-lane', [
                                  m('.bl-slice.bl-slice-green', { style: { left: '3%', width: '25%' } }, m('span.bl-slice-label', 'updateScene'))
                                ]),
                                m('.bl-timeline-lane', [
                                  m('.bl-slice.bl-slice-green', { style: { left: '30%', width: '20%' } }, m('span.bl-slice-label', 'processInput'))
                                ])
                              ]),
                              m('.bl-timeline-lane', [
                                m('.bl-slice.bl-slice-orange', { style: { left: '55%', width: '13%' } }, [
                                  m('span.bl-slice-label', 'Layout'),
                                  m('span.bl-slice-duration', '2.1ms')
                                ])
                              ]),
                              m('.bl-timeline-lane', [
                                m('.bl-slice.bl-slice-purple', { style: { left: '70%', width: '12%' } }, [
                                  m('span.bl-slice-label', 'Paint'),
                                  m('span.bl-slice-duration', '1.8ms')
                                ])
                              ]),
                              !State.collapsedTracks['paint'] && m('.bl-lane-children', { 'data-track': 'paint' }, [
                                m('.bl-timeline-lane', [
                                  m('.bl-slice.bl-slice-purple', { style: { left: '71%', width: '5%' } }, m('span.bl-slice-label', 'drawRect'))
                                ]),
                                m('.bl-timeline-lane', [
                                  m('.bl-slice.bl-slice-purple', { style: { left: '77%', width: '4%' } }, m('span.bl-slice-label', 'rasterize'))
                                ])
                              ])
                            ])
                          ])
                        ]),

                        // GPU Lanes
                        m('.bl-lane-group', {
                          'data-group': 'gpu',
                          class: State.collapsedTrackGroups['gpu'] ? 'collapsed' : ''
                        }, [
                          m('.bl-lane-group-header'),
                          m('.bl-lane-group-content', [
                            m('.bl-timeline-lane', [
                              m('.bl-slice.bl-slice-red', { style: { left: '3%', width: '45%' } }, [
                                m('span.bl-slice-label', 'Render Pass'),
                                m('span.bl-slice-duration', '7.2ms')
                              ])
                            ]),
                            m('.bl-timeline-lane', [
                              m('.bl-slice.bl-slice-teal', { style: { left: '50%', width: '35%' } }, [
                                m('span.bl-slice-label', 'Compositing'),
                                m('span.bl-slice-duration', '5.6ms')
                              ])
                            ])
                          ])
                        ]),

                        // Worker Lanes
                        m('.bl-lane-group', {
                          'data-group': 'workers',
                          class: State.collapsedTrackGroups['workers'] ? 'collapsed' : ''
                        }, [
                          m('.bl-lane-group-header'),
                          m('.bl-lane-group-content', [
                            m('.bl-timeline-lane', [
                              m('.bl-slice.bl-slice-yellow', { style: { left: '5%', width: '20%' } }, m('span.bl-slice-label', 'parseGeometry'))
                            ]),
                            m('.bl-timeline-lane', [
                              m('.bl-slice.bl-slice-yellow', { style: { left: '10%', width: '15%' } }, m('span.bl-slice-label', 'decodeTexture'))
                            ])
                          ])
                        ])
                      ])
                    ])
                  ])
                ])
              ])
            ]),

            m('.profiler-resize-handle', { id: 'resizeHandle' }),

            // Details Panel
            m('.profiler-details', { id: 'detailsPanel', style: { height: State.detailsPanelHeight + 'px' } }, [
              m('.profiler-details-tabs-primary', [
                m('.details-primary-tabs', [
                  ['Selection', 'History', 'Flame Graph', 'Statistics'].map(function(tab) {
                    return m('button.details-primary-tab', {
                      class: State.activePrimaryTab === tab ? 'active' : '',
                      onclick: function() { State.activePrimaryTab = tab; }
                    }, tab);
                  })
                ]),
                m('.profiler-details-actions', [
                  m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Pin Selection' },
                    m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M10 1L7 4 4.5 3.5 2 6l3.5 2L2 14l6-3.5L10.5 14 13 11.5 12.5 9l3-3z"/></svg>')),
                  m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Clear History' },
                    m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 4l8 8M12 4l-8 8" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>'))
                ])
              ]),
              m('.profiler-details-header', [
                m('.details-secondary-tabs', [
                  ['Summary', 'Call Stack', 'Bottom-Up', 'Top-Down'].map(function(tab) {
                    return m('button.details-secondary-tab', {
                      class: State.activeSecondaryTab === tab ? 'active' : '',
                      onclick: function() { State.activeSecondaryTab = tab; }
                    }, tab);
                  })
                ])
              ]),
              m('.profiler-details-content', [
                m('.details-grid', [
                  m('.details-section', [
                    m('.details-section-title', 'Selected Slice'),
                    m('.details-row', [
                      m('span.details-label', 'Function'),
                      m('span.details-value.highlight', 'requestAnimationFrame')
                    ]),
                    m('.details-row', [
                      m('span.details-label', 'Duration'),
                      m('span.details-value', '16.4ms')
                    ]),
                    m('.details-row', [
                      m('span.details-label', 'Self Time'),
                      m('span.details-value', '0.4ms')
                    ])
                  ]),
                  m('.details-section', [
                    m('.details-section-title', 'Frame Statistics'),
                    m('.details-row', [
                      m('span.details-label', 'Total Frame Time'),
                      m('span.details-value', '16.4ms')
                    ]),
                    m('.details-row', [
                      m('span.details-label', 'Scripts'),
                      m('span.details-value', '8.2ms (50%)')
                    ]),
                    m('.details-row', [
                      m('span.details-label', 'Layout'),
                      m('span.details-value', '2.1ms (13%)')
                    ]),
                    m('.flame-bar', [
                      m('.flame-bar-segment', { style: { width: '50%', backgroundColor: '#5a9a5a' } }),
                      m('.flame-bar-segment', { style: { width: '13%', backgroundColor: '#d4842a' } }),
                      m('.flame-bar-segment', { style: { width: '11%', backgroundColor: '#8a6ab5' } }),
                      m('.flame-bar-segment', { style: { width: '26%', backgroundColor: '#424242' } })
                    ])
                  ]),
                  m('.details-section', [
                    m('.details-section-title', 'Warnings'),
                    m('.details-row', { style: { color: 'var(--bl-warning)' } }, 'Long frame detected (>16ms budget)')
                  ])
                ])
              ])
            ])
          ]),

          // Status Bar
          m('footer.bl-statusbar', [
            m('span.bl-statusbar-item', 'Frame: 1247'),
            m('span.bl-statusbar-item', 'Duration: 16.4ms'),
            m('span.bl-statusbar-item', '60 FPS target'),
            m('span.bl-statusbar-item', { style: { marginLeft: 'auto', borderRight: 'none' } }, 'Profiler v1.0')
          ])
        ]);
      }
    };

    // Plugins Page
    var PluginsPage = {
      view: function() {
        var plugins = [
          { name: 'Animation Nodes', version: 'v2.3.1', author: 'Jacques Lucke', enabled: true, status: 'Enabled', statusClass: 'bl-badge-success',
            description: 'A powerful node-based visual scripting system for creating complex animations and procedural effects.' },
          { name: 'Hard Ops', version: 'v9.87.2', author: 'Team C', enabled: true, status: 'Enabled', statusClass: 'bl-badge-success',
            description: 'Workflow enhancement addon for hard surface modeling with boolean operations and advanced mesh tools.' },
          { name: 'Node Wrangler', version: 'v1.0', author: 'Blender Foundation', enabled: false, status: 'Disabled', statusClass: '',
            description: 'Built-in addon with shortcuts and tools for efficient node editor workflow in shader and compositor nodes.' },
          { name: 'LoopTools', version: 'v4.6.7', author: 'Bart Crouch', enabled: false, status: 'Disabled', statusClass: '',
            description: 'Mesh editing tools including circle, curve, flatten, and relax operations for cleaner topology.' },
          { name: 'Rigify', version: 'v0.6.5', author: 'Blender Foundation', enabled: true, status: 'Enabled', statusClass: 'bl-badge-success',
            description: 'Automatic rigging system that generates production-ready character rigs with advanced controls.' },
          { name: 'Decal Machine', version: 'v2.4.0', author: 'MACHIN3', enabled: true, status: 'Update Available', statusClass: 'bl-badge-warning',
            description: 'Decal and trim sheet workflow addon for adding surface details without UV mapping complexity.' }
        ];

        return m('.page-plugins', [
          // Header Bar
          m('header.bl-header', [
            m('.bl-header-menu', [
              m('.bl-header-menu-item', 'File'),
              m('.bl-header-menu-item', 'Edit'),
              m('.bl-header-menu-item', 'View'),
              m('.bl-header-menu-item', 'Help')
            ]),
            m('div', { style: { marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: 'var(--bl-spacing-md)' } }, [
              m('input.bl-input[type=text]', { placeholder: 'Search plugins...', style: { width: '200px' } }),
              m('button.bl-btn.bl-btn-primary', 'Install Plugin')
            ])
          ]),

          m('.plugins-main', [
            m('.plugins-list', plugins.map(function(plugin) {
              return m('.plugin-item', { class: plugin.enabled ? '' : 'disabled' }, [
                m('.plugin-header', [
                  m('label.bl-checkbox', [
                    m('input[type=checkbox]', { checked: plugin.enabled })
                  ]),
                  m('.plugin-info', [
                    m('.plugin-name', plugin.name),
                    m('.plugin-version', plugin.version)
                  ]),
                  m('.plugin-actions', [
                    m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'Settings' },
                      m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0-8a6 6 0 0 1 4.47 10.02l.73.73a.5.5 0 0 1-.71.71l-.73-.73A6 6 0 1 1 8 2z"/></svg>')),
                    m('button.bl-btn.bl-btn-icon.bl-tooltip', { 'data-tooltip': 'More' },
                      m.trust('<svg viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="3" r="1.5"/><circle cx="8" cy="8" r="1.5"/><circle cx="8" cy="13" r="1.5"/></svg>'))
                  ])
                ]),
                m('.plugin-description', plugin.description),
                m('.plugin-meta', [
                  m('span.bl-badge', { class: plugin.statusClass }, plugin.status),
                  m('span.plugin-author', 'by ' + plugin.author)
                ])
              ]);
            }))
          ]),

          // Status Bar
          m('footer.bl-statusbar', [
            m('span.bl-statusbar-item', 'Plugins: 6 total'),
            m('span.bl-statusbar-item', '4 enabled'),
            m('span.bl-statusbar-item', '2 disabled'),
            m('span.bl-statusbar-item', { style: { marginLeft: 'auto', borderRight: 'none' } }, 'Plugin Manager v1.0')
          ])
        ]);
      }
    };

    // Layout wrapper
    var Layout = {
      view: function(vnode) {
        return m('.app-layout', [
          m(Nav),
          m('main.app-main', vnode.children)
        ]);
      }
    };

    // Route configuration
    m.route(document.getElementById('app'), '/widgets', {
      '/widgets': {
        render: function() {
          return m(Layout, m(WidgetsPage));
        }
      },
      '/profiler': {
        render: function() {
          return m(Layout, m(ProfilerPage));
        }
      },
      '/plugins': {
        render: function() {
          return m(Layout, m(PluginsPage));
        }
      }
    });
  </script>
</body>
</html>
